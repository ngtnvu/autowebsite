function Edm(){var self=this;var ct=0;var timeoutId;this.init=function(){self.jquery();};this.jquery=function(){$('#all-menu-left li').hover(function(){var w=$(this).find('div').width();$(this).find('div').stop().animate({left:'-'+w+'px'},200);},function(){$(this).find('div').stop().animate({left:'0px'},200);});$('.btn-menu-survey').click(function(){var h=$('#survey-content').height();if(!$(this).hasClass('survey-act')){$(this).addClass('survey-act');$('#survey-menu').css('overflow','visible');}else{$(this).removeClass('survey-act');$('#survey-menu').css('overflow','hidden');}});$('#province_regis').bind('change',function(){var id=$(this).val();$.post(root+'blocks/get_dealer',{id:id},function(dt){$('#dealer_regis').selectbox('detach');$('#dealer_regis').html(dt);$('#dealer_regis').selectbox('attach');});});$("#survey-menu").mouseover(function(){clearTimeout(timeoutId);}).mouseout(function(){timeoutId=setTimeout(function(){$('#survey-menu').css('overflow','hidden');},2000);$('.btn-menu-survey').removeClass('survey-act');});};this.add=function(form){form.find('.error_edm').hide();form.find('.popup-edm-1').show();form.find('.popup-edm-2').hide();form.find('.error_edm').removeClass('success_edm');form.find('.error_edm').html('<p>Đang xử lý...</p>').show();var e=form.find('#submit_edm').attr('onclick');var form_data=form.serialize();form.find('.submit_edm').attr('onclick','');$.post(root+'edm/add',form_data,function(data){form.find('.submit_edm').attr('onclick',e);if(data.status==200||data.status==405){window.location.href=root+'dang-ky-nhan-tin-thanh-cong';$('.popup-edm-2').show();$('.popup-edm-1').hide();form.find('.error_edm').addClass('success_edm');Edm.clear_form('#'+form.attr('id'));}else{form.find('.error_edm').html(data.msg);form.find('.error_edm').show();}
setTimeout(function(){form.find('.error_edm').fadeOut();if(data.status==200||data.status==405){$.fancybox.close();}},2000);setTimeout(function(){if(data.status==200||data.status==405){$('.popup-edm-2').hide();$('.popup-edm-1').show();}},3000);},'json');};this.regis=function(form){form.find('.error_edm').hide();form.find('.error_edm').removeClass('success_edm');form.find('.error_edm').html('<p>Đang xử lý...</p>').show();var e=form.find('.submit_edm').attr('onclick');var form_data=form.serialize();form.find('.submit_edm').attr('onclick','');$.post(root+'contact_me/add',form_data,function(data){form.find('.submit_edm').attr('onclick',e);if(data.status==200||data.status==405){window.location.href=root+'lien-he-voi-toi-thanh-cong';form[0].reset();$('#province_regis').selectbox('detach');$('#province_regis option[value="0"]').attr('selected','selected');$('#province_regis').selectbox('attach');$('#dealer_regis').selectbox('detach');$('#dealer_regis').html('<option value="0">Chọn đại lý</option>');$('#dealer_regis').selectbox('attach');form.find('.error_edm').addClass('success_edm');}else{form.find('.error_edm').html(data.msg);form.find('.error_edm').show();}
setTimeout(function(){form.find('.error_edm').fadeOut();if(data.status==200||data.status==405){$.fancybox.close()}},2000);},'json');};this.clear_form=function(form){$(form+' input[type="text"]').val('');$(form+' textarea').val('');};this.validate_input=function(evt){var theEvent=evt||window.event;var key=theEvent.keyCode||theEvent.which;var keychar=String.fromCharCode(key);var keycheck=/[0-9]/;if(!(key==8||key==27||key==46||key==37||key==39)){if(!keycheck.test(keychar)){theEvent.returnValue=false;if(theEvent.preventDefault)
theEvent.preventDefault();}}};};Edm=new Edm();$(document).ready(function(){Edm.init();});